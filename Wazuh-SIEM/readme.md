# Wazuh - Setting up and Kicking the tires

### Table of Contents

- [Why Wazuh?](https://github.com/Xerips/ArchLinux/tree/main/Defence!/Wazuh-SIEM#why-wazuh)
- [Documentation Review](https://github.com/Xerips/ArchLinux/tree/main/Defence!/Wazuh-SIEM#documentation-review-getting-started)
- [Set'er up!](https://github.com/Xerips/ArchLinux/tree/main/Defence!/Wazuh-SIEM#seter-up)
- [Kicking The Tires](https://github.com/Xerips/ArchLinux/tree/main/Defence!/Wazuh-SIEM#kicking-the-tires)

### Why Wazuh?

- Wazuh is a great open source SIEM that has XDR capabilities. XDR stands for Extended Detection and Response which means it automatically correlates data across multiple security layers - Like email, endpoint, server, cloud, and networks.
- So XDR means that it includes multiple Detect and Respond capabilities including both Endpoint Detection and Response and Network Detection and Response
- It's open source! This means we can see the code and that there is a community supporting it. Anyone interested in participating with the project need only join the community. This is so cool!
- Free! It can be hard to learn some of the tools used in cyber security because so many come with costly yearly licensing fees. Finding the free or cheap options to practice your skills is incredibly valuable!
- It's well designed for small to mid-sized environments. That doesn't mean it isn't scalable, it just doesn't need scale to be useful.
  - You can scale Wazuh through clustering Agents.
- Built in alerting!
- Primarily used for security monitoring, threat detection, and compliance.
- A nice set of documentation for us to get started on their websites [Documentation Page](https://documentation.wazuh.com/current/index.html).

Why not E.L.K.(Elasticsearch, Logstash, Kibana)?

- Why not bring a monster truck to a soap box derby? Although ELK is powerful and widely used, it doesn't quite fit in with our system.
- No built in alerting. You'll need to plug in to other tools to have notifications and alerts.
- ELK is designed to handle massive amounts of data. There may be reasons for people to use ELK even though it doesn't fit their requirements, like practicing with it because you're looking for a job with a company that uses it. However, it's also important to understand what tool is right for the job. Just like a carpenter needs to know the difference between a framing hammer and a sledge, I think it is equally important for IT workers to understand their tools - so I'm trying to do that.
- I'll probably still play with this at some point because it is so ubiquitous and powerful.
- Primarily used for log analysis, operational monitoring, and gleaning insights from large data collection through visualization.
  - We might not be able to generate enough events to really see value from ELK.

### Documentation Review: "Getting Started"

When we start looking through the documentation we see that there are 4 components to Wazuh: Indexer, Server, Dashboard, and Agents. Here's what the docs say about each:

**Components:**

- [Indexer](https://documentation.wazuh.com/current/getting-started/components/wazuh-indexer.html): "The Wazuh indexer is a highly scalable, full-text search and analytics engine. This Wazuh central component indexes and stores alerts generated by the Wazuh server and provides near real-time data search and analytics capabilities. The Wazuh indexer can be configured as a single-node or multi-node cluster, providing scalability and high availability."
- [Server](https://documentation.wazuh.com/current/getting-started/components/wazuh-server.html): "The Wazuh server component analyzes the data received from the agents, triggering alerts when threats or anomalies are detected. It is also used to manage the agents configuration remotely and monitor their status." It also mentions how you can integrate ServiceNow, Jira, PagerDuty, and Slack, and how it enriches alert data with MITRE ATT&CK, PCI DSS, GDPR, CIS, and NIST 800-53 to provide context. Nice!
  - It also lets us know that it's typical to run the server on a standalone physical machine, VM, docker container, or cloud instance.
- [Dashboard](https://documentation.wazuh.com/current/getting-started/components/wazuh-dashboard.html): "The Wazuh dashboard is a flexible and intuitive web user interface for mining, analyzing, and visualizing security events and alerts data. It is also used for the management and monitoring of the Wazuh platform. Additionally, it provides features for role-based access control (RBAC) and single sign-on (SSO)."
  - There are some nice screenshots of the different dashboards here and some information about what's available through Wazuh dashboards.
- [Agents](https://documentation.wazuh.com/current/getting-started/components/wazuh-agent.html): "The Wazuh agent runs on Linux, Windows, macOS, Solaris, AIX, and other operating systems. It can be deployed to laptops, desktops, servers, cloud instances, containers, or virtual machines. The agent helps to protect your system by providing threat prevention, detection, and response capabilities. It is also used to collect different types of system and application data that it forwards to the Wazuh server through an encrypted and authenticated channel."
  - Agents are deployed with a modular architecture which allows you to enable or disable each module component to suit your needs. These are the different agent modules:
    - Log Collector
    - Command Execution
    - File Integrity Monitoring (FIM)
    - Security Configuration Assessment (SCA)
    - System Inventory
    - Malware Detection
    - Active Response
    - Container Security Monitoring
    - Cloud Security Monitoring
  - Agent-Server communication is done through a secure channel (TCP or UDP), and includes flow control mechanisms to avoid flooding, queueing events when necessary, and protecting the network bandwidth. It will play nice with our system and try not to eat up all our resources.

**Architecture:**

- The architecture is based on agents which run on monitored endpoints. These agents forward data to the Wazuh server to be digested.
- You can also collect data from agentless devices like Firewalls, Switches, Routers, and Access Points with Syslog, SSH, or their API.
- Once the data is collected and sent to the server, the service will decode and analyze the data and passes the results to the Wazuh indexer for, you guessed it, indexing and storage.
- Small deployments (that's us!) can easily be handled by a single-node cluster.
- You'll want multi-node clusters if any of the following apply to you: Many monitored endpoints, a large volume of data is anticipated, or when high availability is required.
- Production environments should deploy Wazuh server and Wazuh indexer to different hosts. This makes sense. You would want your server to be set up with the resources required to handle the traffic being sent to it. It's easier to do this reliably if you're setting up a host to handle this anticipated load, and nothing else. The Indexer needs things that the server doesn't, in particular storage. You'd hate to bog down your server with a bunch of read/write tasks while it's trying to handle incoming data from a large network of agents.
- Filebeat is used to securely forward Wazuh alerts and archived events to the Wazuh indexer using TLS encryption.

Here's a diagram:  
![Wazuh Architecture](https://github.com/Xerips/ArchLinux/blob/main/Defence!/Wazuh-SIEM/deployment-architecture1.png)

**Wazuh Agent-Server Communication:**

- The Wazuh agent continuously sends events to the Wazuh server. The agent establishes a connection with the server service, which listens on Port 1514 by default.
- Wazuh server decodes and rule-checks the received events with its analysis engine.
- Events that trip a rule are given rule ID and rule name and all events are sorted into the file `/var/ossec/logs/alerts/alerts.json`. All events, regardless of whether they trip a rule, are spooled into `/var/ossec/logs/archives/archives.json`.
- Wazuh message protocol uses AES encryption with 128 bits per block and 256-bit keys. Blowfish encryption is optional.

**Wazuh Server-Indexer Communication:**

- Filebeat reads the Wazuh server output data and send it to the indexer (listens on port 9200/TCP by default).
- Once indexed, the Wazuh dashboard mines and visualizes the information.
- Wazuh Dashoboard queries the Wazuh RESTful API (default 55000/TCP on Wazuh server) to display config and status-related info of the Wazuh Server and Agents.
- Can modify agents or server configuration through API calls.
- Authenticated with username:password and is TLS encrypted.

**Required Ports**
|Component|Port|Protocol|Purpose|
|---|---|---|---|
| Wazuh Server|1514|TCP (Default)|Agent Connection Service|
| |1514|UDP (Optional)|Agent Connection Service (Disabled by default)|
| |1515|TCP|Agent Enrollment Service|
| |1516|TCP|Wazuh Cluster Daemon|
| |514|UDP (Default)|Wazuh Syslog Collector (Disabled by Default)|
| |514|TCP (Optional)|Wasuh Syslog Collector (Disabled by Default)|
| |55000|TCP|Wazuh Server RESTful API
|Wazuh Indexer|9200|TCP|Wazuh Indexer RESTful API|
| |9300-9400|TCP|Wazuh Indexer Cluster Communication|
|Wazuh Dashboard|443|TCP|Wazuh Web User Interface|

**Archival Data Storage**

- Both alerts and non alerts are stored in files on the Wazuh server and can be stored in either `.json` or in plain text `.log` files.
- These files are compressed daily and signed using MD5, SHA1, and SHA256 checksums.
- See the directory and filename structure with: `root@wazuh-manager:/var/ossec/logs/archives/2024/Jan$ ls -la`
- This will return:  
  total 176  
  -rw-r----- 1 wazuh wazuh 234350 Jan 2 00:00 ossec-archive-01.json.gz  
  -rw-r----- 1 wazuh wazuh 350 Jan 2 00:00 ossec-archive-01.json.sum  
  -rw-r----- 1 wazuh wazuh 176221 Jan 2 00:00 ossec-archive-01.log.gz  
  -rw-r----- 1 wazuh wazuh 346 Jan 2 00:00 ossec-archive-01.log.sum  
  -rw-r----- 1 wazuh wazuh 224320 Jan 2 00:00 ossec-archive-02.json.gz  
  -rw-r----- 1 wazuh wazuh 350 Jan 2 00:00 ossec-archive-02.json.sum  
  -rw-r----- 1 wazuh wazuh 151642 Jan 2 00:00 ossec-archive-02.log.gz  
  -rw-r----- 1 wazuh wazuh 346 Jan 2 00:00 ossec-archive-02.log.sum  
  -rw-r----- 1 wazuh wazuh 315251 Jan 2 00:00 ossec-archive-03.json.gz  
  -rw-r----- 1 wazuh wazuh 350 Jan 2 00:00 ossec-archive-03.json.sum  
  -rw-r----- 1 wazuh wazuh 156296 Jan 2 00:00 ossec-archive-03.log.gz  
  -rw-r----- 1 wazuh wazuh 346 Jan 2 00:00 ossec-archive-03.log.sum

- Wazuh recommends backups according to the storage capacity of the Wazuh server.
- Wazuh suggest using cron jobs to only keep a specified window of backups (3 months, 6 months, a year, depending on storage limitations)
- Last note: "you may choose to dispense with storing archive files and simply rely on the Wazuh indexer for archive storage. This alternative might be preferred if you run periodic Wazuh indexer snapshot backups and/or have a multi-node Wazuh indexer cluster with shard replicas for high availability. You could even use a cron job to move snapshotted indices to a final data storage server and sign them using MD5, SHA1, and SHA256 hashing algorithms."

**Use Cases**  
This is a nice addition to the documentation, click any of the use cases in the table below to navigate to the specified documentation.

| Endpoint Security                                                                                                           | Threat Intelligence                                                                                                       | Security Operations                                                                                                   | Cloud Security                                                                                                          |
| --------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| [Configuration Assessment](https://documentation.wazuh.com/current/getting-started/use-cases/configuration-assessment.html) | [Threat Hunting](https://documentation.wazuh.com/current/getting-started/use-cases/threat-hunting.html)                   | [Incident Response](https://documentation.wazuh.com/current/getting-started/use-cases/incident-response.html)         | [Container Security](https://documentation.wazuh.com/current/getting-started/use-cases/container-security.html)         |
| [Malware Detection](https://documentation.wazuh.com/current/getting-started/use-cases/malware-detection.html)               | [Log Data Analysis](https://documentation.wazuh.com/current/getting-started/use-cases/log-analysis.html)                  | [Regulatory Compliance](https://documentation.wazuh.com/current/getting-started/use-cases/regulatory-compliance.html) | [Posture Management](https://documentation.wazuh.com/current/getting-started/use-cases/posture-management.html)         |
| [File Integrity Monitoring](https://documentation.wazuh.com/current/getting-started/use-cases/file-integrity.html)          | [Vulnerability Detection](https://documentation.wazuh.com/current/getting-started/use-cases/vulnerability-detection.html) | [IT Hygiene](https://documentation.wazuh.com/current/getting-started/use-cases/it-hygiene.html)                       | [Workload Protection](https://documentation.wazuh.com/current/getting-started/use-cases/cloud-workload-protection.html) |

### Set'er up!

**Requirements:**

Hardware Requirements Based on Deploying Wazuh Server, Indexer, and Dashboard on the same host:
|Agents|CPU|RAM|Storage (90 days)|
|---|---|---|---|
|1-25|4 vCPUs|8 GiB|50 GB|
|25-50|8 vCPUs|8 GiB|100 GB|
|50-100|8 vCPUs|8 GiB|200 GB|

- Larger environments may require distributed deployments with Multi-node cluster configuration for server and indexer to provide high availability and load balancing.

**Recommended OS:** Red Hat Enterprise Linux 7, 8, 9 or Ubuntu 16.04, 18.04, 20.04, 22.04

**Browser Compatibility:** Chrome 95 or later, Firefox 93 or later, Safari 13.7 or later. Other Chromium-based browsers might also work.

#### Installation:

Here we will walk through setting up Qemu to install our Ubuntu server, a general
**Qemu setup:**

If you're planning on running multiple servers, or want a "base server install" to be able to reinstall wazuh on a fresh server, do the installation as "Ubuntu-22.04-Server" (or whatever name makes sense to you), then clone the server to make a fresh install of the wazuh server, indexer, and dashboard.

1. Launch virt-manager and click the "Create a new virtual machine" icon in the top left.
2. Toggle "Local install media (ISO image or CDROM)" and click "Forward".
3. Browse to where you downloaded the ubuntu server .iso, select it, and click "Choose Volume."
4. Click "Forward" again once virt-manager shows you the iso you've selected.
5. For memory we follow the recommendations of 8 GiB converted to 8192 MiB and 4 vCPUs.
6. Select 50GB storage (GiB (46.57) and GB (50) are pretty close, just enter 50).
7. We name our machine Wazuh, and toggle "Customize configuration before install"

- This opens up a menu that should look familiar if you've used other hypervisors before.

8. We want to change the CPUs Topology in "CPUs" by toggling "Manually set CPU topology" then setting Sockets: 1, Cores: 4, Threads: 1 (or 2).
9. Everything looked like it was set up properly by default (besides that weird topology), so we can click the begin installation button.
10. If you wanted to run this server every time you log in you can by going to "View" > "Boot Options" > toggle "Start Virtual Machine on host boot up"

**Install Ubuntu Server:**

1. Hop through the install prompts, I decided to go with the regular ubuntu server, not the ubuntu server minimized. I did a quick google and it looks like minimized doesn't install any text editors or other tools that might be necessary to set things up, so we will just go with the standard.
2. When you get to "Guided Storage Configuration" select `( ) Custom storage layout`
3. Create a boot partition:

   - Select "free space" under AVAILABLE DEVICES, Select "Add GPT Partition", Size: 512M, Format: Leave unformatted

4. Create a swap partition:

   - Select "free Space", "Add GPT Partition", Size: 8192M", Format: "swap"

5. Create root partition:

   - Select "free space", "Add GPT Partition", Size: <leave blank for use entire disk>", format: "ext4"

- I've decided to go with one large partition because I'm not exactly sure how much space is going to be used up in /var, /opt, /home, etc.
- This option lets us run, configure, and install anything we need on our ubuntu server without having to worry about running out of space in a partition we underestimate.

3. "Skip for now" on Upgrade to Ubuntu Pro.
4. (X) Install OpenSSH server
5. You can look through the "Featured Server Snaps" to see if anything looks interesting, we are just using wazuh on the server, so we shouldn't need any of these options.
6. If you get errors after selecting "Reboot now," just ctrl+c and it should be able to reboot (it will unmount the installation media).

- From the server enter `ip a` to see the IP of the server
- From your host machine, enter `ssh <server IP>` and use the user password that you set up in install to login.
- You're now logged in as the user you created during the server install process.

7. From here we're ready to install Wazuh!

- If you're going the clone route (recommended), clone your "Ubuntu-22.04-Server" to "Wazuh-FreshInstall" by right clicking on the ubuntu server in virt-manager.

**Install Wazuh Server, Dashboard and Indexer:**
The Wazuh documentation is pretty easy to follow. We will just need to follow the [Quickstart](https://documentation.wazuh.com/current/quickstart.html) guide to get us up and running.

1. Download and Install the Wazuh installation assistant from your ssh session with the Ubuntu server.

- `curl -sO https://packages.wazuh.com/4.7/wazuh-install.sh && sudo bash ./wazuh-install.sh -a`
- It's good to note that this command would be extremely sketchy if you were to use it to install something from an unknown or unproven source. It's essentially downloading a file that's hosted on the web, and then piping it to bash and executing the script. You should always inspect your sources and check the contents of the scripts you're running. Blindly running a command like this could result in a, "I can't believe they actually did it..." for malicious actors and is a very efficient way to infect yourself with malware.
- You should be seeing the installation progress after running the above command.
- At the very end of the installation, the script will print out your new username as `User: admin` and the password for your dashboard with `Password: <password string here>`
- Save your password in a safe place.

2. Check out the dashboard:

- From a browser on your host machine, enter: `https://<server IP>`
- You will get a warning about certificates, but we know what we're accessing (we're hosting it after all), so we continue to the dashboard.
- You'll notice there is no option for an Arch Linux install using "add agent" button. You'll have to find the documentation for installation on their documentation page, ["Installing The Wazuh agent from sources"](https://documentation.wazuh.com/current/deployment-options/wazuh-from-sources/wazuh-agent/index.html)

  **Installing a Wazuh agent on Arch Linux:**

1. Install the recommended packages, a lot of these we already have installed, but that's ok:

- `sudo pacman --noconfirm -Syu curl gcc make sudo wget expect gnupg perl-base perl fakeroot python brotli automake autoconf libtool gawk libsigsegv nodejs base-devel inetutils cmake`
- You shouldn't normally run `sudo pacman --noconfirm`, as this removes all the "are you sure?" prompts from the package manager. I'm not sure why they have it listed in their documents to do so.

2. Download and extract the latest version:

- `curl -Ls https://github.com/wazuh/wazuh/archive/v4.7.3.tar.gz | tar zx`
- Run this command from the directory you want to install the latest version in. ex: `/home/$(whoami)/Wazuh.`

3. CD into the directory you just pulled down and run the install.sh file:

- `sudo ./install.sh`

4. Follow the prompts of the install script:
1. `en` for english.
1. Press ENTER to continue.
1. `agent` because we want to install an agent.
1. Where you want to install the agent, default is /var/ossec.
1. Input your Wazuh servers IP address.
1. Determine the functionality of your agent:

   - Select y or press enter if you want to run an integrity check daemon.
   - Select y or press enter if you want to run a rootkit detection engine.
   - Select y or press enter if you want to enable active response.
   - Select y if you want to add more certificates (default is no).
   - "If you want to monitor any other file, just change the ossec.conf and add a new localfile entry. Any questions about the configuration can be answered by visiting us online at https://documentation.wazuh.com/."

1. Press enter and watch'er go!
1. The final print out from the installation:

```
Done building agent

Wait for success...
success
Removing old SCA policies...
Installing SCA policies...


egrep: warning: egrep is obsolescent; using grep -E
Created symlink /etc/systemd/system/multi-user.target.wants/wazuh-agent.service → /etc/systemd/system/wazuh-agent.service.

 - Configuration finished properly.

 - To start Wazuh:
      /var/ossec/bin/wazuh-control start

 - To stop Wazuh:
      /var/ossec/bin/wazuh-control stop

 - The configuration can be viewed or modified at /var/ossec/etc/ossec.conf
```

This print out is a little misleading. To start the agent you need to enter the following in your terminal:  
`sudo systemctl daemon-reload`  
`sudo systemctl enable wazuh-agent.service`  
`sudo systemctl start wazuh-agent.service`  
This will start the agent as a service so it will persist after you reboot.

If you reload your browser the Wazuh Dashboard, you should see your total agents are now 1.  
You can also check if your wazuh-manager.service is running on your server.

- Connect through ssh and enter `sudo systemctl wazuh-manager.service`. It should say `Active: active (running)`

Adding additional agents is really easy if you're running windows, a linux distro using apt or rpm, or macOS.
Just go to the wazuh drop down, select agents, then deploy new agent. It will give you copy and paste commands to add the agents, super quick and easy.

### Kicking The Tires

It's time to see how good/bad our basic Arch Linux install is!  
Here's a look at our new dashboard:  
![Wazuh Dashboard](https://github.com/Xerips/ArchLinux/blob/main/Defence!/Wazuh-SIEM/wazuh-dashboard.png)

- Let's move to our agents dashboard to see our active agent.
- You can do this by clicking on the "1" under "Total agents" or "Active agents," otherwise, you can click the downward arrow beside "wazuh." at the top of the dashboard and select "Agents."

This will bring up the following dashboard:  
![Agents Dashboard](https://github.com/Xerips/ArchLinux/blob/main/Defence!/Wazuh-SIEM/agents-dashboard.png)

- In this dashboard we will be able to see all of our agents, and can click on them to drill deeper into what's going on and what the wazuh scans have returned.

Click on the arch agent as the red arrow in the picture indicates to visit the specific agent's dashboard:  
![Arch Agent Dashboard](https://github.com/Xerips/ArchLinux/blob/main/Defence!/Wazuh-SIEM/arch-agent-dashboard.png)

I've highlighted some of the boxes to point out some cool features.

- The **Orange box** shows MITRE ATT&CK results which leverages the MITRE ATT&CK knowledge base of adversary tactics and techniques that you're system could be vulnerable to. This is a super easy way to quickly visualize issues that may interfere with effective cybersecurity.
- The **Red box** is useful for those who need to comply with specific standards like Payment Card Industry Data Security Standard (PCI DSS) or NIST 800-53 which is the National Institute of Standards and Technology's Security and Privacy Controls for Information Systems and Organizations. I know, it's a mouth full. Imagine how much easier it would be to comply to these standards by having your SIEM do a scan and let you know what you need to get in compliance than to otherwise have to step through the (very) lengthy documentation and compare those standards to your system configurations. If you need to be in compliance to any of these standards, it's definitely important to be intimately familiar with them, but if you're just starting out, what a great way to get familiar!
- The **Purple box** shows FIM: Recent events. This is our file integrity monitoring window. This box will show any alerts that are triggered when the Wazuh agent scans the directory paths it's been configured to look through for any file changes. It will look for file modifications by comparing the checksums of a file to it's stored checksums and attribute values, then generates an alert if it finds any discrepancies.
- The **Cyan box** Is the Security Configuration Assessment. Let's click on the "System audit for Unix based systems" and see why we only got a score of 14%.

The arch agent's SCA dashboard:
![SCA-Arch Scan](https://github.com/Xerips/ArchLinux/blob/main/Defence!/Wazuh-SIEM/SCA-arch.png)

- In the above image, I've clicked on the first failed scan which is titled "SSH Hardening: Port should not be 22."
  - Wazuh provides a "Rationale" to communicate why the suggestion to change the port number was given.
  - They also tell you in "Remediation" where to make the changes to pass the test, a "Description" of what's going on, which seems to be almost an extension of "Remediation," and under "Compliance" it shows where it has gotten these check rules from (NIST_800_53: CM.1 and PCI_DSS: 2.2.4).
- This makes it super easy to make changes to get into compliance, understand why the compliance standard is in place, and where to look for more information.
- Let's step through the failed tests and see if we can get our system on the right track!

- We can go to our ssh configs with, `cd /etc/ssh/` and take a look at our sshd_config as directed.
- Now we can uncomment lines and change the values for system wide changes. Doing the SSH config this way will ensure any users that are added to our arch linux machine will have the same settings.
- When we open the sshd_config file with nvim, there is some handy information right at the top, thanks OpenSSH!:

```
# The strategy used for options in the default sshd_config shipped with
# OpenSSH is to specify options with their default value where
# possible, but leave them commented. Uncommented options override the
# default value.
```

- Looks like we're in the right place to do some system wide configuration.
- We can use the `ss` command which shows socket statistics on linux machines.
  - Get a list of all listening ports with `ss -l`
  - Search who is responsible for opening a specific port with `ss -lp | grep <specific port>`
  - Finding out if a specific port is in use is valuable, we don't want to accidentally assign a port to ssh that is already in use.
- Now we have the tools we need and the info on what to change, let's make some quick changes, restart the wazuh agent to re-scan our system, and see what happens to our System Audit score...
  ![SCA Fixed](https://github.com/Xerips/ArchLinux/blob/main/Defence!/Wazuh-SIEM/SCA-Fixed.png)
- There we have it! Because of the easy to follow breakdown: with 2 config files, 1 terminal command, and a few minutes of changes we increased our System audit score from 14% to 92%. It should be 100%. I fixed the LoginGraceTime 120 failure but for some reason wazuh isn't picking up on it. This is something to look into, not something to ignore. There is a reason why that check failed, and it's best to understand why.
- Now, this was pretty easy to fix up; it's a fresh machine, we don't have a lot of integration with other services or a bunch of people who were using SSH that we needed to enroll in the new changes. In reality things can take much more time and planning. That being said, having a tool like this that can help you quickly identify low hanging fruit and a gives you a direct path to take action can certainly help with that planning and definitely save time on the researching and finding of documentation fast.
- If we go back to our arch agent menu, we can see we've generated some MITRE ATT&CK events when we restarted our agent.

![Arch Agent Dashboard 2](https://github.com/Xerips/ArchLinux/blob/main/Defence!/Wazuh-SIEM/arch-agent-dashboard2.png)

There is so much more you can do with wazuh and a SIEM in general. It's hard to believe that you can just download something like this - it's so easy to use, it's open source, and it's completely free to do what we've done here! I'll be doing more with wazuh as I get into more fun stuff with our "Dirty Twin," and I'll definitely be setting up an agent on a windows machine to play around with that as well! **Stay tuned nerds, the fun is just beginning!**
